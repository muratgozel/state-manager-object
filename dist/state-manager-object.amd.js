define(["basekits","event-emitter-object"],(function(t,e){"use strict";function i(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var n=i(t),r=i(e),a=n.default.typekit,o=n.default.objectkit,u=n.default.validationkit;return{create:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;if(!a.isObject(t))throw new Error("Invalid initial state.");var e=r.default.create(),i={state:t,prevState:null};function n(t){if(!a.isObject(t))throw new Error("Invalid payload.");var n=c(),r=Object.assign({},n,t);u.isEqual(n,r)||(i.state=r,i.prevState=n,e.emit("update",[i.state,i.prevState]))}function f(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,n="string"==typeof t?t:void 0,r=void 0===n?t:i;if("function"!=typeof r)throw new Error("Subscriber function should be a type of function.");e.on("update",(function(t,e){var i=n?o.getProp(t,n):t,a=n?o.getProp(e,n):e;u.isEqual(i,a)||r(i,a)}))}function c(){return i.state}function d(){return i.prevState}return{getState:c,getPrevState:d,updateState:n,subscribe:f}}}}));
