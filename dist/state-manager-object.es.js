import t from"event-emitter-object";import{validationkit as e,objectkit as i}from"basekits";function o(e,i){t.call(this,i),this.checkInitialState(e)}o.prototype=Object.create(t.prototype),o.prototype.constructor=o,o.prototype._state={},o.prototype._prevState=null,o.prototype.checkInitialState=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;e.isObject(t)&&(this._state=t)},o.prototype.updateState=function(t){if(e.isObject(t)){var i=Object.assign({},this.getState()),o=Object.assign({},i,t);return!e.isEqual(i,o)&&(this._prevState=i,this._state=o,this.emit("update",[this.getState(),this.getPrevState()]),!0)}},o.prototype.subscribe=function(t,o){e.isFunction(o)&&(e.isString(t)||e.isArray(t))&&this.on("update",(function(r,a){var s=i.getProp(a,t),p=i.getProp(r,t);e.isEqual(p,s)||o(p,s)}))},o.prototype.getState=function(){return this._state},o.prototype.getPrevState=function(){return this._prevState};export default o;
