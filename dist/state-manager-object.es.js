import t from"basekits";import e from"event-emitter-object";var r=t.typekit,i=t.objectkit,a=t.validationkit;var o={create:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;if(!r.isObject(t))throw new Error("Invalid initial state.");var o=e.create(),n={state:t,prevState:null};function u(t){if(!r.isObject(t))throw new Error("Invalid payload.");var e=c(),i=Object.assign({},e,t);a.isEqual(e,i)||(n.state=i,n.prevState=e,o.emit("update",[n.state,n.prevState]))}function v(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,r="string"==typeof t?t:void 0,n=void 0===r?t:e;if("function"!=typeof n)throw new Error("Subscriber function should be a type of function.");o.on("update",(function(t,e){var o=r?i.getProp(t,r):t,u=r?i.getProp(e,r):e;a.isEqual(o,u)||n(o,u)}))}function c(){return n.state}function f(){return n.prevState}return{getState:c,getPrevState:f,updateState:u,subscribe:v}}};export default o;
