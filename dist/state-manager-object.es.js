import t from"basekits";import e from"event-emitter-object";var r=t.typekit,a=t.objectkit,i=t.validationkit;var n={create:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;if(!r.isObject(t))throw new Error("Invalid initial state.");var n=e.create(),o={state:t,prevState:null};function u(t){if(!r.isObject(t))throw new Error("Invalid payload.");var e=s(),a=Object.assign({},e,t);i.isEqual(e,a)||(o.state=a,o.prevState=e,n.emit("update",[o.state,o.prevState]))}function v(t,e){n.on("update",(function(i,n){var o=a.getProp(i,t),u=a.getProp(n,t);r.isEqual(o,u)||e(o,u)}))}function s(){return o.state}function c(){return o.prevState}return{getState:s,getPrevState:c,updateState:u,subscribe:v}}};export default n;
