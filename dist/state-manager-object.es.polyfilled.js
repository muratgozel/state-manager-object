import t from"event-emitter-object";import{validationkit as e,objectkit as n}from"basekits";var r="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function o(t,e){return t(e={exports:{}},e.exports),e.exports}var i=function(t){return t&&t.Math==Math&&t},u=i("object"==typeof globalThis&&globalThis)||i("object"==typeof window&&window)||i("object"==typeof self&&self)||i("object"==typeof r&&r)||Function("return this")(),c=function(t){try{return!!t()}catch(t){return!0}},f=!c((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]})),a={}.propertyIsEnumerable,s=Object.getOwnPropertyDescriptor,p={f:s&&!a.call({1:2},1)?function(t){var e=s(this,t);return!!e&&e.enumerable}:a},l=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}},y={}.toString,h="".split,g=c((function(){return!Object("z").propertyIsEnumerable(0)}))?function(t){return"String"==function(t){return y.call(t).slice(8,-1)}(t)?h.call(t,""):Object(t)}:Object,b=function(t){if(null==t)throw TypeError("Can't call method on "+t);return t},v=function(t){return g(b(t))},d=function(t){return"object"==typeof t?null!==t:"function"==typeof t},m=function(t,e){if(!d(t))return t;var n,r;if(e&&"function"==typeof(n=t.toString)&&!d(r=n.call(t)))return r;if("function"==typeof(n=t.valueOf)&&!d(r=n.call(t)))return r;if(!e&&"function"==typeof(n=t.toString)&&!d(r=n.call(t)))return r;throw TypeError("Can't convert object to primitive value")},j={}.hasOwnProperty,O=function(t,e){return j.call(t,e)},S=u.document,w=d(S)&&d(S.createElement),P=!f&&!c((function(){return 7!=Object.defineProperty((t="div",w?S.createElement(t):{}),"a",{get:function(){return 7}}).a;var t})),_=Object.getOwnPropertyDescriptor,E={f:f?_:function(t,e){if(t=v(t),e=m(e,!0),P)try{return _(t,e)}catch(t){}if(O(t,e))return l(!p.f.call(t,e),t[e])}},T=function(t){if(!d(t))throw TypeError(String(t)+" is not an object");return t},k=Object.defineProperty,M={f:f?k:function(t,e,n){if(T(t),e=m(e,!0),T(n),P)try{return k(t,e,n)}catch(t){}if("get"in n||"set"in n)throw TypeError("Accessors not supported");return"value"in n&&(t[e]=n.value),t}},x=f?function(t,e,n){return M.f(t,e,l(1,n))}:function(t,e,n){return t[e]=n,t},I=function(t,e){try{x(u,t,e)}catch(n){u[t]=e}return e},F=u["__core-js_shared__"]||I("__core-js_shared__",{}),q=Function.toString;"function"!=typeof F.inspectSource&&(F.inspectSource=function(t){return q.call(t)});var L,N,z,A,C=F.inspectSource,D=u.WeakMap,G="function"==typeof D&&/native code/.test(C(D)),W=o((function(t){(t.exports=function(t,e){return F[t]||(F[t]=void 0!==e?e:{})})("versions",[]).push({version:"3.6.5",mode:"global",copyright:"Â© 2020 Denis Pushkarev (zloirock.ru)"})})),K=0,R=Math.random(),V=W("keys"),Y={},B=u.WeakMap;if(G){var H=new B,J=H.get,Q=H.has,U=H.set;L=function(t,e){return U.call(H,t,e),e},N=function(t){return J.call(H,t)||{}},z=function(t){return Q.call(H,t)}}else{var X=V[A="state"]||(V[A]=function(t){return"Symbol("+String(void 0===t?"":t)+")_"+(++K+R).toString(36)}(A));Y[X]=!0,L=function(t,e){return x(t,X,e),e},N=function(t){return O(t,X)?t[X]:{}},z=function(t){return O(t,X)}}var Z={set:L,get:N,has:z,enforce:function(t){return z(t)?N(t):L(t,{})},getterFor:function(t){return function(e){var n;if(!d(e)||(n=N(e)).type!==t)throw TypeError("Incompatible receiver, "+t+" required");return n}}},$=o((function(t){var e=Z.get,n=Z.enforce,r=String(String).split("String");(t.exports=function(t,e,o,i){var c=!!i&&!!i.unsafe,f=!!i&&!!i.enumerable,a=!!i&&!!i.noTargetGet;"function"==typeof o&&("string"!=typeof e||O(o,"name")||x(o,"name",e),n(o).source=r.join("string"==typeof e?e:"")),t!==u?(c?!a&&t[e]&&(f=!0):delete t[e],f?t[e]=o:x(t,e,o)):f?t[e]=o:I(e,o)})(Function.prototype,"toString",(function(){return"function"==typeof this&&e(this).source||C(this)}))})),tt=u,et=function(t){return"function"==typeof t?t:void 0},nt=Math.ceil,rt=Math.floor,ot=function(t){return isNaN(t=+t)?0:(t>0?rt:nt)(t)},it=Math.min,ut=Math.max,ct=Math.min,ft=function(t){return function(e,n,r){var o,i,u=v(e),c=(o=u.length)>0?it(ot(o),9007199254740991):0,f=function(t,e){var n=ot(t);return n<0?ut(n+e,0):ct(n,e)}(r,c);if(t&&n!=n){for(;c>f;)if((i=u[f++])!=i)return!0}else for(;c>f;f++)if((t||f in u)&&u[f]===n)return t||f||0;return!t&&-1}},at={includes:ft(!0),indexOf:ft(!1)}.indexOf,st=function(t,e){var n,r=v(t),o=0,i=[];for(n in r)!O(Y,n)&&O(r,n)&&i.push(n);for(;e.length>o;)O(r,n=e[o++])&&(~at(i,n)||i.push(n));return i},pt=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],lt=pt.concat("length","prototype"),yt={f:Object.getOwnPropertyNames||function(t){return st(t,lt)}},ht={f:Object.getOwnPropertySymbols},gt=function(t,e){return arguments.length<2?et(tt[t])||et(u[t]):tt[t]&&tt[t][e]||u[t]&&u[t][e]}("Reflect","ownKeys")||function(t){var e=yt.f(T(t)),n=ht.f;return n?e.concat(n(t)):e},bt=function(t,e){for(var n=gt(e),r=M.f,o=E.f,i=0;i<n.length;i++){var u=n[i];O(t,u)||r(t,u,o(e,u))}},vt=/#|\.prototype\./,dt=function(t,e){var n=jt[mt(t)];return n==St||n!=Ot&&("function"==typeof e?c(e):!!e)},mt=dt.normalize=function(t){return String(t).replace(vt,".").toLowerCase()},jt=dt.data={},Ot=dt.NATIVE="N",St=dt.POLYFILL="P",wt=dt,Pt=E.f,_t=Object.keys||function(t){return st(t,pt)},Et=function(t){return Object(b(t))},Tt=Object.assign,kt=Object.defineProperty,Mt=!Tt||c((function(){if(f&&1!==Tt({b:1},Tt(kt({},"a",{enumerable:!0,get:function(){kt(this,"b",{value:3,enumerable:!1})}}),{b:2})).b)return!0;var t={},e={},n=Symbol();return t[n]=7,"abcdefghijklmnopqrst".split("").forEach((function(t){e[t]=t})),7!=Tt({},t)[n]||"abcdefghijklmnopqrst"!=_t(Tt({},e)).join("")}))?function(t,e){for(var n=Et(t),r=arguments.length,o=1,i=ht.f,u=p.f;r>o;)for(var c,a=g(arguments[o++]),s=i?_t(a).concat(i(a)):_t(a),l=s.length,y=0;l>y;)c=s[y++],f&&!u.call(a,c)||(n[c]=a[c]);return n}:Tt;function xt(e,n){t.call(this,n),this.checkInitialState(e)}!function(t,e){var n,r,o,i,c,f=t.target,a=t.global,s=t.stat;if(n=a?u:s?u[f]||I(f,{}):(u[f]||{}).prototype)for(r in e){if(i=e[r],o=t.noTargetGet?(c=Pt(n,r))&&c.value:n[r],!wt(a?r:f+(s?".":"#")+r,t.forced)&&void 0!==o){if(typeof i==typeof o)continue;bt(i,o)}(t.sham||o&&o.sham)&&x(i,"sham",!0),$(n,r,i,t)}}({target:"Object",stat:!0,forced:Object.assign!==Mt},{assign:Mt}),xt.prototype=Object.create(t.prototype),xt.prototype.constructor=xt,xt.prototype._state={},xt.prototype._prevState=null,xt.prototype.checkInitialState=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;e.isObject(t)&&(this._state=t)},xt.prototype.updateState=function(t){if(e.isObject(t)){var n=Object.assign({},this.getState()),r=Object.assign({},n,t);return!e.isEqual(n,r)&&(this._prevState=n,this._state=r,this.emit("update",[this.getState(),this.getPrevState()]),!0)}},xt.prototype.subscribe=function(t,r){e.isFunction(r)&&(e.isString(t)||e.isArray(t))&&this.on("update",(function(o,i){var u=n.getProp(i,t),c=n.getProp(o,t);e.isEqual(c,u)||r(c,u)}))},xt.prototype.getState=function(){return this._state},xt.prototype.getPrevState=function(){return this._prevState};export default xt;
